<img src="https://brightblock.org/logo/bm-logo-kight-blue.png" alt="BigMarket Logo" style="width: auto; max-width: 500px; display: inline-block; margin: 1rem auto;align:left;" />

# BigMarket Contracts

## Description

A system of smart contracts, based on [Executor DAO](https://github.com/Clarity-Innovation-Lab/executor-dao),
for community ownership and management of on-chain prediction market machinery.

## Development

- Vite
- Clarinet SDK
- Stacks.js

To run tests:

```bash
git clone ..
cp Clarinet-Devnet.toml Clarinet.toml // setup devnet and unit test config
npm install
npm run watch
```

The Clarinet-Devnet.toml toml file contains all contracts needed for unit tests - this is quite a few because a proposal contract is needed to change the state of the dao;

```bash
brew install clarinet // system dependant
clarinet check
clarinet devnet start
```

To test bitcoin predicitons on devnet some btc can be transferred using;

```
clarinet deployments apply -p deployments/send-btc.devnet-plan.yaml --no-dashboard
```

Note: the contracts in extensions/linear are legacy contract not implementing CPMM curve mechanics. They are included in unit tests but excluded from testnet config.

```note
CPMM contracts:
bme023 = old linear prediction contracts
bme024 = new CPMM curve prediction contracts
```

## Deployment

Thje project is deployed with the following keys;

- testnet: [ST3FM52ANQES92X27AP9ZV9Z676MHP7QP2J79RTH9](https://explorer.hiro.so/address/ST3FM52ANQES92X27AP9ZV9Z676MHP7QP2J79RTH9?chain=testnet)
- mainnet: [TBD]

In general each deployment on testnet has its own root key generated by;

```bash
stx make_keychain -t % stx make_keychain --backup_phrase -t ""
```

Contracts can be deployed to testnet either manually or using a deployment descriptor.

The testnet toml file (Clarinet-Testnet.toml) contains the contracts needed for testnet. Note the Pyth contract references must be manually updated - see note at top of bme024-0-market-scalar-pyth.clar.

```bash
clarinet deployments apply -p deployments/default.devnet-plan.yaml --no-dashboard
```

or deploy manually using sandbox in order following address [ST3FM52ANQES92X27AP9ZV9Z676MHP7QP2J79RTH9](https://explorer.hiro.so/address/ST3FM52ANQES92X27AP9ZV9Z676MHP7QP2J79RTH9?chain=testnet);
